# igNeurons

## overview 
These are scripts used for the paper: "A human-specific microRNA controls the timing of excitatory synaptogenesis."
Please contact me directly if you have any questions to one of the files or markdowns.
Generally the data and scripts are sorted by experiment. They are further divided in "data" folders containing raw data,
"R" folders with scripts used for data processing and statistical analysis and "Figure" folders to generate the figures 
used in the paper. The files in the "Figure Output" folders were generated with these scripts and it should be possible to 
reproduce them using the provided information. In case something is not working or there are questions you can contact me 
or create an issue.

## requirements
R packages needed to run the scripts are listed in the "library" chunks. CellProfiler 4 (https://cellprofiler.org/)
was used for the image analysis. I am happy to help out if any of the scripts is not working with a specific package
version. 

## apps
Custom developed Shiny Apps for Ca-Imaging analysis (https://ethz-ins.org/SpikeIt/), microRNA binding site analysis (https://ethz-ins.org/scanMiR/)
or microRNA enrichment analysis (https://ethz-ins.org/enrichMiR/) are freely available online.

## igNeuron time course data
The different igNeuron time course datasets can be accessed at https://ethz-ins.org/igNeuronsTimeCourse/.

## Folder Content

### 00_functions
This folder contains custom functions needed to execute some of the markdowns, such as for example the clustering of 
the TimeCours RNA-Sequencing Data

### 01_TimeCourse_MultiOmics
Here are all the scripts used for the analysis of the MultiOmics timecourse experiment. It is divided in a "Proteomics" and
a "smallRNA" section as well as two folders for the ribosomal depletion sequencing data. For most of the paper we used the 
RNA-Seq analysis based on a STAR mapping to Ensembl91, for the comparison to other datasets ("stageing") we used an RNA-Seq
analysis based on salmon mapping to Ensembl112. The "data" folders contain the SummarizedExperiment files including the DEAs,
the "R" folders include scripts to generate the SE-files, scripts to run differential expression analyses as well as scripts
to cluster the datasets. 
Scripts to generate figures based on this experiment can be found in the Figures_Omics folder, including the scripts to compare
our dataset to the mouse neuronal differentiation dataset generated by Whipple et al., 2020. 

### 02_Image_Analysis
The image analysis folder is divided in experiments done to quantify neuronal morphology (such as synapse or dendrite development)
and mitochondrial morphology. Cell Profiler pipelines to quantify input images can be found in the respective experimental folder.
Example images for each experiment can be provided upon request since the file size of individual tif images is too big for a 
convenient handling in the git repository. A single example image to illustrate the concept of the synaptogenesis cell profiler pipelines 
can be found in "Image_Analysis/pLNA_experiment/Synapses/Example_Image". The cell profiler output files can be imported in R and 
should contain the relevant column titles used for further analysis or figure generation. Result .rds files are stored for each 
experiment to be able to reproduce figures.

### 03_pLNA_GRCh38.p13_Ens107
Here are the scripts to work with the RNA-Sequencing dataset generated upon inhibition of miR-1229-3p, as well as miR-181c. The R folder
contains again scripts to generate SE-objects and the DEAs. Additionally, it includes scripts for GO-Term and EnrichMiR analyses. Scripts 
to screen for miRNA binding sites with scanMiR can be found in Target_Analysis. Plotting scripts as well as figures are stored in the Figure
folder.

### 04_TaqMan_qPCR
Scripts to analyze and plot the qPCR data.

### 05_Ephys
Scripts to plot the Ephys data.

### 06_Ca-Imaging
This folder contains scripts to analyze the output of the SpikeIt shiny app which we used to quantify our Ca-Imaging data
from the timecourse and mitochondrial activation experiment. Calcium peak tables can be found in "raw", scripts to prepare
plotting data.frames as well as for the actual plotting of the figures in "R".

### 07_Sy5y_GRCh38.p13_Ens107
All data and relevant scripts used to analyze the miR-1229-3p overexpression experiment in SH-Sy5y cells are in this folder. 
Scripts to generate the SE-Objects and perform DEAs are in the longRNA_R folder. Here are also the scripts stored to perform EnrichMiR,
as well as GSEA and GO-Term analyses on the DEAs. The "Target_Analysis" folder contains scripts to find putative miR-1229-3p target 
genes in the genes differentially expressed upon miR-1229-3p overexpression as well as a script to compare those targets to the timecourse
data. The GO-Term subfolder contains the script to perform a GO-Term analysis on those identified possible miR-1229-3p target genes.
The Figures folder in 07_Sy5y_GRCh38.p13_Ens107 contains the figures included in the paper as well as scripts to plot GO-Term, GSEA,
heatmap and volcano plots. Scripts to generate the miRNA-target plots are stored in "Targets".

### 08_Luminescence
Scripts to plot the luminescence experiments (such as luciferase to test miRNA targeting of 3'UTRs as well as the lactate 
quantification).

### 09_Conservation_analyses
This folder contains scripts to scripts and figures for the miRNA target conservation analysis as well as the actual miRNA
precursor conservation analysis. Here we also save the 1000Genome plot as well as snapshots of UCSC-tracks including Neandertal 
and Denisovan RNA-sequencing reads in the genomic region of miR-1229-3p.

### 10_miRNA_expression_HumanTissue
Scripts to plot the miRNA expression analyses from human post-mortem tissue samples can be found in this folder. 

